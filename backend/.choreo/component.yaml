schemaVersion: "1.2"

endpoints:
  - name: rest-api-be2
    displayName: REST API
    service:
      basePath: /
      port: 8000
      # healthCheckPath: /health   # (opcional) cria /health no backend
    type: REST
    networkVisibilities: [ Project, Public ]

# DIZ ao Choreo onde está o backend (monorepo)
build:
  workingDirectory: ./backend
  commands:
    - pip install -r requirements.txt

run:
  workingDirectory: ./backend
  command: uvicorn main:app --host 0.0.0.0 --port 8000
  containerPort: 8000

# Variáveis não-secretas (os segredos mete no UI)
env:
  - name: API_PREFIX
    value: "/api"
  - name: DEBUG
    value: "True"
  - name: DATABASE_URL
    value: "sqlite:///./database.db"
  - name: ALLOWED_ORIGINS
    value: '["http://localhost:5173","http://localhost:3000"]'

dependencies:
  connectionReferences:
    - name: openai-connection
      resourceRef: thirdparty:openai/v1
